name: Download Gemini API Docs

permissions:
  contents: write

on:
  push:
    branches:
      - main
  workflow_dispatch:

jobs:

  download-docs:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Create docs directory
        run: mkdir -p docs

      - name: Download all documentation files
        run: |
          set -euxo pipefail

          # Get started
          curl -fsSL -o docs/docs.md https://ai.google.dev/gemini-api/docs.md.txt
          curl -fsSL -o docs/quickstart.md https://ai.google.dev/gemini-api/docs/quickstart.md.txt
          curl -fsSL -o docs/api-key.md https://ai.google.dev/gemini-api/docs/api-key.md.txt
          curl -fsSL -o docs/libraries.md https://ai.google.dev/gemini-api/docs/libraries.md.txt
          curl -fsSL -o docs/interactions.md https://ai.google.dev/gemini-api/docs/interactions.md.txt

          # Models
          curl -fsSL -o docs/models.md https://ai.google.dev/gemini-api/docs/models.md.txt
          curl -fsSL -o docs/gemini-3.md https://ai.google.dev/gemini-api/docs/gemini-3.md.txt
          curl -fsSL -o docs/nanobanana.md https://ai.google.dev/gemini-api/docs/nanobanana.md.txt
          curl -fsSL -o docs/video.md https://ai.google.dev/gemini-api/docs/video.md.txt
          curl -fsSL -o docs/music-generation.md https://ai.google.dev/gemini-api/docs/music-generation.md.txt
          curl -fsSL -o docs/imagen.md https://ai.google.dev/gemini-api/docs/imagen.md.txt
          curl -fsSL -o docs/embeddings.md https://ai.google.dev/gemini-api/docs/embeddings.md.txt
          curl -fsSL -o docs/robotics-overview.md https://ai.google.dev/gemini-api/docs/robotics-overview.md.txt
          curl -fsSL -o docs/pricing.md https://ai.google.dev/gemini-api/docs/pricing.md.txt
          curl -fsSL -o docs/rate-limits.md https://ai.google.dev/gemini-api/docs/rate-limits.md.txt

          # Core capabilities
          curl -fsSL -o docs/text-generation.md https://ai.google.dev/gemini-api/docs/text-generation.md.txt
          curl -fsSL -o docs/video-understanding.md https://ai.google.dev/gemini-api/docs/video-understanding.md.txt
          curl -fsSL -o docs/document-processing.md https://ai.google.dev/gemini-api/docs/document-processing.md.txt
          curl -fsSL -o docs/structured-output.md https://ai.google.dev/gemini-api/docs/structured-output.md.txt
          curl -fsSL -o docs/function-calling.md https://ai.google.dev/gemini-api/docs/function-calling.md.txt
          curl -fsSL -o docs/long-context.md https://ai.google.dev/gemini-api/docs/long-context.md.txt

          # Tools
          curl -fsSL -o docs/tools.md https://ai.google.dev/gemini-api/docs/tools.md.txt
          curl -fsSL -o docs/deep-research.md https://ai.google.dev/gemini-api/docs/deep-research.md.txt
          curl -fsSL -o docs/google-search.md https://ai.google.dev/gemini-api/docs/google-search.md.txt
          curl -fsSL -o docs/maps-grounding.md https://ai.google.dev/gemini-api/docs/maps-grounding.md.txt
          curl -fsSL -o docs/code-execution.md https://ai.google.dev/gemini-api/docs/code-execution.md.txt
          curl -fsSL -o docs/url-context.md https://ai.google.dev/gemini-api/docs/url-context.md.txt
          curl -fsSL -o docs/computer-use.md https://ai.google.dev/gemini-api/docs/computer-use.md.txt
          curl -fsSL -o docs/file-search.md https://ai.google.dev/gemini-api/docs/file-search.md.txt

          # Live API
          curl -fsSL -o docs/live.md https://ai.google.dev/gemini-api/docs/live.md.txt
          curl -fsSL -o docs/live-guide.md https://ai.google.dev/gemini-api/docs/live-guide.md.txt
          curl -fsSL -o docs/live-tools.md https://ai.google.dev/gemini-api/docs/live-tools.md.txt
          curl -fsSL -o docs/live-session.md https://ai.google.dev/gemini-api/docs/live-session.md.txt
          curl -fsSL -o docs/ephemeral-tokens.md https://ai.google.dev/gemini-api/docs/ephemeral-tokens.md.txt

          # Advanced
          curl -fsSL -o docs/batch-api.md https://ai.google.dev/gemini-api/docs/batch-api.md.txt
          curl -fsSL -o docs/files.md https://ai.google.dev/gemini-api/docs/files.md.txt
          curl -fsSL -o docs/caching.md https://ai.google.dev/gemini-api/docs/caching.md.txt
          curl -fsSL -o docs/openai.md https://ai.google.dev/gemini-api/docs/openai.md.txt
          curl -fsSL -o docs/media-resolution.md https://ai.google.dev/gemini-api/docs/media-resolution.md.txt
          curl -fsSL -o docs/tokens.md https://ai.google.dev/gemini-api/docs/tokens.md.txt
          curl -fsSL -o docs/prompting-strategies.md https://ai.google.dev/gemini-api/docs/prompting-strategies.md.txt

      - name: Commit and push changes
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          git config user.name "GitHub Action"
          git config user.email "action@github.com"
          git add docs/
          git commit -m "Update Gemini API documentation" || true
          git push https://${{ github.actor }}:${{ env.GITHUB_TOKEN }}@github.com/${{ github.repository }}.git
